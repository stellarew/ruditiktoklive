name: Auto Generate Directory Listing

on:
  push:
    branches: [ main ]
    paths:
      - 'htmllive/**'

jobs:
  generate_listing:
    # Blok 'permissions' harus berada di bawah 'generate_listing:'
    permissions:
      contents: write
      
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      # Langkah untuk mengatur identitas Git (disarankan untuk auto-commit)
      - name: Configure Git User
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"

      # Langkah ini akan otomatis membuat index.html di folder htmllive
      - name: Generate Directory Listings for htmllive
        uses: jayanta525/github-pages-directory-listing@v4.0.0
        with:
          FOLDER: htmllive
          OUTPUT_DIR: htmllive
          
      # Langkah ini akan melakukan commit file index.html yang baru dibuat
      - name: Commit and Push Changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Auto: Update directory listing in htmllive/"
          branch: main
          token: ${{ secrets.GITHUB_TOKEN }}